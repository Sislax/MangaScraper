@page "/{mangaId:int}"
@using MangaScraper.Data.Models.DTOs
@using MangaView.Utiles
@inject HttpClient _httpClient;
@inject Settings _settings;

<MudText>Lista dei volumi e dei capitoli del manga @mangaDTO.Nome.</MudText>
<MudDivider />
<MudItem>
    @foreach (VolumeDTO volume in mangaDTO.Volumi)
    {
        <MudDivider />
        <MudText>@volume.NumVolume</MudText>
        @foreach (CapitoloDTO capitolo in volume.Capitoli)
        {
            <MudText>@capitolo.NumCapitolo</MudText>
        }

    }
</MudItem>


@code {
    [Parameter] public int mangaId { get; set; }

    public MangaDTO mangaDTO = new MangaDTO();

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();

        mangaDTO = await _httpClient.GetFromJsonAsync<MangaDTO>(_settings.ApiUrl + $"Manga/GetMangaDTOWithAllData?id={mangaId}") ?? throw new Exception();
    }
}
